{% extends 'base.html' %}

{% block head %}
<h1 style="text-align: center;">OKR</h1>
{% endblock %}

{% block body %}

<tbody>
    <tr data-toggle="collapse" data-target="#test"  class="clickable">
        <td>
            hehe
        </td>
    </tr>

</tbody>

<div class="content">
    {% if objectives|length < 1%}
    There are no objectives create one below.<br>
    {% else %}

    {% for objective in objectives %}
    <br>
        Objective: {{ objective.content }} (<a href="/update/objective/{{objective.id}}">Update</a> | <a href="/delete/objective/{{objective.id}}">Delete</a>)<br>
        <!-- ID: {{ objective.id }}<br> -->

        <!-- Key Results:<br> -->
        {% if objective.key_results|length < 1%}
            <span class="tab"></span>There are no key results.
        {% else %}
            {% for kr in objective.key_results %}
                <span class="tab"></span>Key Result: {{kr.content}} (<a href="/update/key_result/{{kr.id}}">Update</a> | <a href="/delete/key_result/{{kr.id}}">Delete</a>)<br>

                {% if kr.tasks|length < 1%}
                    <span class="tab"></span><span class="tab"></span>There are no tasks.<br>
                {% else %}
                    {% for task in kr.tasks %}
                        <span class="tab"></span><span class="tab"></span>Task: {{task.content}} (<a href="/update/task/{{task.id}}">Update</a> | <a href="/delete/task/{{task.id}}">Delete</a>)<br>
                    {% endfor %}
               {% endif %}
               <form action="/create/task" method="POST">
                    <!-- TODO: move style to css -->
                    <input type="text" name="task_content" id="task_content" style="margin-left: 80px;">
                    <input type="hidden" name="key_result_id" value="{{kr.id}}">
                    <input type="submit" value="Add task">
                </form>

            {% endfor %}
        {% endif %}
        <form action="/create/key_result" method="POST">
            <!-- TODO: move style to css -->
            <input type="text" name="key_result_content" id="key_result_content" style="margin-left: 40px;">
            <input type="hidden" name="objective_id" value="{{objective.id}}">
            <input type="submit" value="Add key result">
        </form>
    {% endfor %}

    <br>
    <br>
    {% endif %}
    
    <form action="/create/objective" method="POST">
        <input type="text" name="objective_content" id="objective_content">
        <input type="submit" value="Add objective">
    </form>

    <!-- <br>
    <h1>Key Results</h1>
    <table>
        <tr>
            <th>Key Result</th>
            <th>Id</th>
            <th>Task</th>
            <th>Actions</th>
        </tr>

        {% for objective in objectives %}
            <tr>
                <td>{{ objective.content }}</td>
                <td>{{ objective.id }}</td>
                <td>{{ objective.key_results }}</td>
                <td>
                    <a href="/delete/objective/{{objective.id}}">Delete</a>
                    <br>
                    <a href="/update/objective/{{objective.id}}">Update</a>
                </td>
            </tr>
        {% endfor %}
    </table>
    <form action="/" method="POST">
        <input type="text" name="key_result_content" id="key_result_content">
        <input type="submit" value="Add Key Result">
    </form> -->

</div>
{% endblock %}